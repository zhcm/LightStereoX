DATA_CONFIG:
    DATA_INFOS:
        -   DATASET: SceneFlowDataset
            DATA_SPLIT: {
                TRAINING: ./data/sceneflow/sceneflow_finalpass_train.txt,
                EVALUATING: ./data/sceneflow/sceneflow_finalpass_test.txt,
                TESTING: ./data/sceneflow/sceneflow_finalpass_test.txt
            }
            DATA_PATH: /mnt/nas/algorithm/chenming.zhang/dataset/SceneFlow
            RETURN_RIGHT_DISP: false

    DATA_TRANSFORM:
        TRAINING:
#            - { NAME: StereoColorJitter, BRIGHTNESS: [ 0.6, 1.4 ], CONTRAST: [ 0.6, 1.4 ], SATURATION: [ 0.6, 1.4 ], HUE: 0.5, ASYMMETRIC_PROB: 0.2 }
#            - { NAME: RandomErase, PROB: 0.5, MAX_TIME: 2, BOUNDS: [ 50, 100 ] }
#            - { NAME: RandomScale, SIZE: [ 320, 736 ], MIN_SCALE: -0.2, MAX_SCALE: 0.4, SCALE_PROB: 0.8, STRETCH_PROB: 0.8 }
            - { NAME: RandomCrop, SIZE: [ 320, 736 ], Y_JITTER: false }
            - { NAME: TransposeImage }
            - { NAME: ToTensor }
            - { NAME: NormalizeImage, MEAN: [ 0.485, 0.456, 0.406 ], STD: [ 0.229, 0.224, 0.225 ] }
        EVALUATING:
            - { NAME: RightTopPad, SIZE: [ 544, 960 ] }
            - { NAME: TransposeImage }
            - { NAME: ToTensor }
            - { NAME: NormalizeImage, MEAN: [ 0.485, 0.456, 0.406 ], STD: [ 0.229, 0.224, 0.225 ] }

MODEL:
    NAME: LightFast
    MAX_DISP: 192
    EXPANSE_RATIO: 4
    AGGREGATION_BLOCKS: [1, 2, 4]
    LEFT_ATT: true
    FIND_UNUSED_PARAMETERS: false
    CKPT: -1
    PRETRAINED_MODEL: ''

OPTIMIZATION:
    FREEZE_BN: false
    SYNC_BN: true
    AMP: true
    BATCH_SIZE_PER_GPU: 24
    NUM_EPOCHS: 90

    OPTIMIZER:
        NAME: AdamW
        LR: &lr 0.0024
        WEIGHT_DECAY: 1.0e-05
        EPS: 1.0e-08

    SCHEDULER:
        NAME: OneCycleLR
        MAX_LR: *lr
        PCT_START: 0.01
        ON_EPOCH: False

    CLIP_GRAD:
        TYPE: value
        CLIP_VALUE: 0.1

EVALUATOR:
    BATCH_SIZE_PER_GPU: 12
    MAX_DISP: 192
    METRIC:
        - d1_all
        - epe
        - thres_1
        - thres_2
        - thres_3

TRAINER:
    EVAL_INTERVAL: 1
    CKPT_SAVE_INTERVAL: 1
    MAX_CKPT_SAVE_NUM: 30
    LOGGER_ITER_INTERVAL: 10
    TRAIN_VISUALIZATION: True
    EVAL_VISUALIZATION: True