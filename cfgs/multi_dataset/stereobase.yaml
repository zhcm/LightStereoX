DATA_CONFIG:
    DATA_INFOS:
        -   DATASET: VirtualKitti2Dataset
            DATA_SPLIT: {
                TRAINING: ./data/VirtualKitti2/virtualkitti2_trainval21260.txt,
                EVALUATING: '',
                TESTING: ''
            }
            DATA_PATH: /mnt/nas/public_data/KITTI/virtualkitti2
            RETURN_RIGHT_DISP: false

        -   DATASET: SceneFlowDataset
            DATA_SPLIT: {
                TRAINING: ./data/sceneflow/sceneflow_finalpass_train.txt,
                EVALUATING: '',
                TESTING: ''
            }
            DATA_PATH: /mnt/nas/algorithm/chenming.zhang/dataset/SceneFlow
            RETURN_RIGHT_DISP: false

        -   DATASET: KittiDataset
            DATA_SPLIT: {
                TRAINING: ./data/kitti12/kitti12_train194.txt,
                EVALUATING: '',
                TESTING: ''
            }
            DATA_PATH: /mnt/nas/algorithm/chenming.zhang/dataset/KITTI/stereo_2012
            RETURN_RIGHT_DISP: false

        -   DATASET: KittiDataset
            DATA_SPLIT: {
                TRAINING: ./data/kitti15/kitti15_train180.txt,
                EVALUATING: ./data/kitti15/kitti15_val20.txt,
                TESTING: ./data/kitti15/kitti15_test.txt
            }
            DATA_PATH: /mnt/nas/algorithm/chenming.zhang/dataset/KITTI/stereo_2015
            RETURN_RIGHT_DISP: false

        -   DATASET: DrivingDataset
            DATA_SPLIT: {
                TRAINING: ./data/DrivingStereo/driving_stereo_train.txt,
                EVALUATING: '',
                TESTING: ''
            }
            DATA_PATH: /mnt/nas/algorithm/chenming.zhang/dataset/DrivingStereo
            RETURN_RIGHT_DISP: false

    DATA_TRANSFORM:
        TRAINING:
            - { NAME: RandomCrop, SIZE: [ 320, 736 ], Y_JITTER: false }
            - { NAME: TransposeImage }
            - { NAME: ToTensor }
        EVALUATING:
            - { NAME: RightTopPad, SIZE: [ 384, 1248 ] }
            - { NAME: TransposeImage }
            - { NAME: ToTensor }

MODEL:
    NAME: StereoBase
    MAX_DISP: &max_disp 192
    BACKBONE: mobilenetv2_100
    COST:
        NUM_GROUPS: 8
        CONCAT_CHANNELS: 8
        USE_CONCAT_VOLUME: false
        USE_GWC_VOLUME: true
    FIND_UNUSED_PARAMETERS: false

OPTIMIZATION:
    FREEZE_BN: false
    SYNC_BN: true
    AMP: true
    BATCH_SIZE_PER_GPU: 12
    NUM_EPOCHS: 90

    OPTIMIZER:
        NAME: AdamW
        LR: &lr 0.0006
        WEIGHT_DECAY: 1.0e-05
        EPS: 1.0e-08

    SCHEDULER:
        NAME: OneCycleLR
        ON_EPOCH: False
        MAX_LR: *lr
        PCT_START: 0.01
        CYCLE_MOMENTUM: False
        ANNEAL_STRATEGY: linear

    CLIP_GRAD:
        TYPE: value
        CLIP_VALUE: 1.0

EVALUATOR:
    BATCH_SIZE_PER_GPU: 8
    MAX_DISP: *max_disp
    METRIC:
        - d1_all
        - epe
        - thres_1
        - thres_2
        - thres_3